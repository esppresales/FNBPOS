/*! Receipt Designer for ePos-Device Version 2.5.0 Copyright (C) SEIKO EPSON CORPORATION 2013. All rights reserved. */
var tabindex=0;$(function(){var g=window.localStorage,d,a,c;var b,e,f;if(g){d=g.getItem("model");if(d){a=d-0;c=$("#setting-model").get(0);if(!isNaN(a)&&a>=0&&a<c.length){c.selectedIndex=a}}d=g.getItem("width");if(d){$("#setting-width").val(d)}d=g.getItem("ipaddr");if(d){$("#setting-ipaddr").val(d);b=d}d=g.getItem("devid");if(d){$("#setting-devid").val(d);e=d}d=g.getItem("timeout");if(d){a=d-0;if(!isNaN(a)&&a>=0&&a<=300000){$("#setting-timeout").val(a);f=a}}d=g.getItem("status");if(d){if(/^(1|true)$/.test(d)){$("#setting-status").attr("checked","checked")}else{if(/^(0|false)$/.test(d)){$("#setting-status").removeAttr("checked")}}}}$("#tabs").tabs({select:function(h,i){switch(tabindex){case 0:try{exportDoc()}catch(j){$("#edit-info").text(j.message);$("#edit-error").dialog("open");return false}break;case 5:exportDoc();if($("#setting-ipaddr").val()!=b||$("#setting-devid").val()!=e||$("#setting-timeout").val()!=f){connectPrinter()}else{setStatusMonitor()}b=$("#setting-ipaddr").val();e=$("#setting-devid").val();f=$("#setting-timeout").val();break;default:break}switch(i.index){case 1:try{drawPreview()}catch(j){$("#edit-info").text(j.message);$("#edit-error").dialog("open");return false}break;case 2:setApiCode();break;case 3:setXmlDoc();break;case 4:setPrintDoc(getXmlDoc());break;default:break}tabindex=i.index},selected:tabindex});$("#edit-left").disableSelection().draggable({axis:"y",containment:"parent"});$("#edit-left li").hover(function(){$(this).addClass("ui-state-highlight")},function(){$(this).removeClass("ui-state-highlight")}).click(function(){var h=$(this).clone();$("#edit-sequence").append(h);extract(h)}).draggable({connectToSortable:"#edit-sequence",helper:"clone"});$("#edit-sequence").sortable({placeholder:"edit-holder",update:function(h,i){extract(i.item)}});$("#edit-clear").button().click(function(){$("#edit-confirm").dialog("open")});$("#edit-confirm").dialog({autoOpen:false,width:400,buttons:[{text:message.yes,click:function(){$(this).dialog("close");$("#edit-sequence li").remove();$("#edit-force").removeAttr("checked");$("#edit-left").css({top:0})}},{text:message.no,click:function(){$(this).dialog("close")}}],show:"fade",hide:"fade",draggable:true,resizable:false,modal:true});$("#edit-import").button().click(function(){$("#import-doc, #import-info").val("");$("#import").dialog("open")});$("#import").dialog({autoOpen:false,width:600,buttons:[{text:message.close,click:function(){$(this).dialog("close")}}],show:"fade",hide:"fade",draggable:true,resizable:false,modal:true});$("#import-apply").button().click(function(){$("#import-confirm").dialog("open")});$("#import-confirm").dialog({autoOpen:false,width:400,buttons:[{text:message.yes,click:function(){$(this).dialog("close");importDoc();$("#edit-left").css({top:0})}},{text:message.no,click:function(){$(this).dialog("close")}}],show:"fade",hide:"fade",draggable:true,resizable:false,modal:true});$("#edit-error").dialog({autoOpen:false,width:600,buttons:[{text:message.ok,click:function(){$(this).dialog("close")}}],show:"fade",hide:"fade",draggable:true,resizable:false,modal:true});$("#api-code, #xml-doc").click(function(){$(this).select()}).keydown(function(h){h.preventDefault()}).bind("paste",function(h){h.preventDefault()});$("#print-info, #import-info").change(function(){this.scrollTop=this.scrollHeight}).keydown(function(h){h.preventDefault()}).bind("paste",function(h){h.preventDefault()});$("#print-send").button().click(function(){sendPrintDoc()});$("#print-clear").button().click(function(){$("#print-info").val("")});$("#setting-model").change(function(){if(/^tm_(l90|p60_la)/.test($(this).val())){$(this).next().fadeIn();$("#setting-width").change()}else{$(this).next().fadeOut()}}).change();$("#setting-width").change(function(){var j=$(this).val()-0,h,i;if(/^tm_l90/.test($("#setting-model").val())){if(isNaN(j)||j>80){j=80}else{if(j<38){j=38}}$(this).val(j);i=Math.min(576,256+((j-38)<<3));h=modelinfo.tm_l90_re;h.width=i;h.page.ini_w=i;h.page.max_w=i;i=Math.min(560,224+((j-38)<<3));h=modelinfo.tm_l90_la;h.width=i;h.page.ini_w=i;h.page.max_w=i}else{if(isNaN(j)||j>60){j=60}else{if(j<29){j=29}}$(this).val(j);i=Math.min(400,152+((j-29)<<3));h=modelinfo.tm_p60_la;h.width=i;h.page.ini_w=i;h.page.max_w=i}}).change();$("#setting-timeout").change(function(){var h=$(this).val()-0;if(isNaN(h)||h>300000){h=60000}else{if(h<1000){h=1000}}$(this).val(h)});$(window).bind("unload",function(h){var i=window.localStorage;if(i){i.setItem("model",$("#setting-model").get(0).selectedIndex);i.setItem("width",$("#setting-width").val());i.setItem("ipaddr",$("#setting-ipaddr").val());i.setItem("devid",$("#setting-devid").val());i.setItem("timeout",$("#setting-timeout").val());i.setItem("status",$("#setting-status").is(":checked"))}});$(window).bind("beforeunload",function(h){return message.unload});connectPrinter()});function extract(a){a.find("button").button({icons:{primary:"ui-icon-close"},text:false}).click(function(){a.fadeOut("fast",function(){$(this).remove()})});a.find(".attr-text-linespc, .attr-feed-unit, .attr-feed-line, .attr-sound-repeat").each(function(){slider($(this),0,255,1)});a.find(".attr-barcode-height").each(function(){slider($(this),1,255,1)});a.find(".attr-logo-key1, .attr-logo-key2").each(function(){slider($(this),32,126,1)});a.find(".attr-hline-x1, .attr-hline-x2, .attr-vline-x, .attr-area-x").each(function(){slider($(this),0,575,1)});a.find(".attr-area-width").each(function(){slider($(this),1,576,1)});a.find(".attr-text-x, .attr-text-y, .attr-area-y, .attr-position-x, .attr-position-y, .attr-line-x1, .attr-line-y1, .attr-line-x2, .attr-line-y2, .attr-rectangle-x1, .attr-rectangle-y1, .attr-rectangle-x2, .attr-rectangle-y2").each(function(){slider($(this),0,1661,1)});a.find(".attr-area-height").each(function(){slider($(this),1,1662,1)});a.find(".attr-text-width, .attr-text-height").each(function(){slider($(this),1,8,1)});a.find(".attr-image-brightness").each(function(){slider($(this),0.1,10,0.1)});a.find(".attr-barcode-width").each(function(){slider($(this),2,6,1)});a.find(".attr-symbol-width").each(function(){slider($(this),0,16,1)});a.find(".attr-symbol-height").each(function(){slider($(this),0,8,1)});a.find(".attr-symbol-size").each(function(){slider($(this),0,1662,1)});a.find(".attr-symbol-level").each(function(){slider($(this),5,95,1)});a.find(".attr-sound-cycle").each(function(){slider($(this),1000,25500,100)});a.find(".attr-layout-width").each(function(){slider($(this),29,60,0.1)});a.find(".attr-layout-height").each(function(){slider($(this),28.4,155,0.1)});a.find(".attr-layout-margin-top").each(function(){slider($(this),-15,150,0.1)});a.find(".attr-layout-margin-bottom").each(function(){slider($(this),-1.5,1.5,0.1)});a.find(".attr-layout-offset-cut").each(function(){slider($(this),-29,5,0.1)});a.find(".attr-layout-offset-label").each(function(){slider($(this),0,1.5,0.1)});a.find(".tooltip-text").hover(function(){a.find(".tooltip:not(:animated)").fadeIn()},function(){a.find(".tooltip").fadeOut()});a.find(".attr-image-load").click(function(){var b=$(this).nextAll(".attr-image").get(0);b.src=$(this).prevAll(".attr-image-file").val()+"?"+new Date().getTime()});a.find(":text").click(function(){$(this).focus()}).keypress(function(b){if(b.which==13){b.preventDefault()}});a.find(".attr-text-data").css("font","medium "+font);a.find(".attr-layout-height-auto").attr("name",new Date().getTime());a.removeClass("ui-state-highlight");a.find(".edit-caption").css("float","left");a.find("div").show()}function slider(d,b,a,c){d.change(function(){var e=d.val()-0;if(isNaN(e)||e<b){e=b}else{if(e>a){e=a}}d.val(e);$(this).next().slider("value",e)}).next().slider({min:b,max:a,value:d.val()-0,step:c,slide:function(e,f){d.val(f.value)}})};